<!--
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  PATCHES index.html â€” Theme Picker + Meta Theme Color
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  1. No <head>, adicionar ANTES de </head>:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
-->
<meta name="theme-color" content="#ef4444">

<!--
  2. Substituir TODO o bloco x-show="showThemePicker" pelo abaixo:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
-->

<!-- â”€â”€ THEME PICKER MODAL â”€â”€ -->
<div
  x-show="showThemePicker"
  x-cloak
  x-transition:enter="transition ease-out duration-200"
  x-transition:enter-start="opacity-0"
  x-transition:enter-end="opacity-100"
  x-transition:leave="transition ease-in duration-150"
  x-transition:leave-start="opacity-100"
  x-transition:leave-end="opacity-0"
  class="fixed inset-0 z-50 flex items-center justify-center px-4"
>
  <!-- Backdrop -->
  <div
    class="absolute inset-0 bg-black/55 backdrop-blur-md"
    @click="showThemePicker = false"
  ></div>

  <!-- Panel -->
  <div
    class="relative w-full max-w-sm rounded-3xl p-0 overflow-hidden"
    style="background:var(--surface-card); box-shadow: var(--shadow-xl), 0 0 0 1px var(--border);"
    x-transition:enter="transition ease-out duration-250"
    x-transition:enter-start="opacity-0 scale-95 translate-y-4"
    x-transition:enter-end="opacity-100 scale-100 translate-y-0"
    x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100 scale-100"
    x-transition:leave-end="opacity-0 scale-95"
  >

    <!-- Live preview strip â€” top of modal, tinted by current theme -->
    <div
      class="relative h-16 overflow-hidden flex items-center justify-between px-6"
      :style="`background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover, #c53030) 100%)`"
    >
      <!-- Decorative circles -->
      <div class="absolute -right-6 -top-6 w-24 h-24 rounded-full opacity-20" style="background:rgba(255,255,255,0.3)"></div>
      <div class="absolute -right-2 top-6 w-12 h-12 rounded-full opacity-10" style="background:rgba(255,255,255,0.4)"></div>
      <div class="absolute left-1/2 -bottom-8 w-32 h-32 rounded-full opacity-10" style="background:rgba(0,0,0,0.2)"></div>

      <div>
        <p class="font-display font-bold text-white text-base leading-tight" x-text="currentTheme.name || 'Personalizado'"></p>
        <p class="text-white/70 text-xs font-mono" x-text="customAccent.toUpperCase()"></p>
      </div>

      <!-- Dark mode toggle inside header strip -->
      <button
        @click="darkMode = !darkMode; saveSetting('darkMode', darkMode)"
        class="flex items-center gap-2 bg-black/20 hover:bg-black/30 rounded-xl px-3 py-1.5 transition-all"
      >
        <span class="text-white/80 text-xs font-medium" x-text="darkMode ? 'ðŸŒ™ Dark' : 'â˜€ï¸ Light'"></span>
        <div class="relative w-9 h-5 rounded-full bg-white/25 flex-shrink-0">
          <div
            class="absolute top-0.5 w-4 h-4 bg-white rounded-full shadow-sm transition-transform duration-300"
            :class="darkMode ? 'translate-x-[18px]' : 'translate-x-0.5'"
          ></div>
        </div>
      </button>
    </div>

    <!-- Body -->
    <div class="p-5">

      <!-- Palette grid -->
      <p class="text-[10px] font-semibold uppercase tracking-widest mb-3" style="color:var(--text-muted)">Paleta de cores</p>

      <div class="grid grid-cols-4 gap-2 mb-5">
        <template x-for="theme in themes" :key="theme.id">
          <button
            @click="setTheme(theme)"
            class="relative flex flex-col items-center gap-1.5 p-2.5 rounded-2xl transition-all duration-200"
            :style="currentTheme.id === theme.id
              ? `background: rgba(${theme.rgb}, 0.12); outline: 2px solid ${theme.accent}; outline-offset: 0px;`
              : `background: var(--surface-muted);`"
          >
            <!-- Color swatch with gradient preview -->
            <div
              class="w-9 h-9 rounded-xl shadow-sm relative overflow-hidden"
              :style="`background: linear-gradient(135deg, ${theme.accent} 0%, ${theme.hover} 100%)`"
            >
              <!-- Checkmark if selected -->
              <div
                x-show="currentTheme.id === theme.id"
                class="absolute inset-0 flex items-center justify-center"
              >
                <svg class="w-4 h-4 text-white drop-shadow" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>
                </svg>
              </div>
            </div>
            <span
              class="text-[10px] font-medium leading-none"
              :style="currentTheme.id === theme.id ? `color: ${theme.accent}` : 'color: var(--text-muted)'"
              x-text="theme.name"
            ></span>
          </button>
        </template>
      </div>

      <!-- Divider -->
      <div class="h-px mb-4" style="background:var(--border)"></div>

      <!-- Custom color -->
      <p class="text-[10px] font-semibold uppercase tracking-widest mb-3" style="color:var(--text-muted)">Cor personalizada</p>

      <div
        class="flex items-center gap-3 p-3 rounded-2xl mb-4 transition-all"
        style="background:var(--surface-muted); border: 1.5px solid var(--border);"
      >
        <!-- Color input styled as large swatch -->
        <label class="relative cursor-pointer flex-shrink-0 group">
          <input
            type="color"
            x-model="customAccent"
            @input="applyCustomColor($event.target.value)"
            class="absolute inset-0 opacity-0 cursor-pointer w-full h-full"
          >
          <div
            class="w-12 h-12 rounded-xl shadow-md ring-2 ring-white/30 group-hover:scale-105 transition-transform"
            :style="`background: linear-gradient(135deg, ${customAccent} 0%, ${darkenHex(customAccent, 0.14)} 100%)`"
          >
            <!-- Eyedropper icon hint -->
            <div class="w-full h-full rounded-xl flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity bg-black/20">
              <svg class="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/>
              </svg>
            </div>
          </div>
        </label>

        <div class="flex-1 min-w-0">
          <p class="text-sm font-semibold font-mono" style="color:var(--text-primary)" x-text="customAccent.toUpperCase()"></p>
          <p class="text-xs mt-0.5" style="color:var(--text-muted)">Clique na cor para trocar</p>
        </div>

        <!-- Mini preview dots showing surface tint -->
        <div class="flex flex-col gap-1 flex-shrink-0">
          <div class="w-4 h-4 rounded-md border" style="background:var(--surface-card); border-color:var(--border)"></div>
          <div class="w-4 h-4 rounded-md border" style="background:var(--surface-muted); border-color:var(--border)"></div>
          <div class="w-4 h-4 rounded-md border" style="background:var(--surface); border-color:var(--border)"></div>
        </div>
      </div>

      <!-- Surface tint explanation -->
      <p class="text-[10px] text-center leading-relaxed mb-4" style="color:var(--text-faint)">
        Os fundos acompanham sutilmente a cor do tema
      </p>

      <!-- Confirm button -->
      <button
        @click="showThemePicker = false"
        class="btn-primary w-full py-3 rounded-2xl text-sm"
      >
        Pronto
      </button>

    </div>
  </div>
</div>
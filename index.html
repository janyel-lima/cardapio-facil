<!DOCTYPE html>
<html lang="pt-br" x-data="menuApp()" :class="{ 'dark': darkMode }" x-init="init()">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title x-text="config.restaurantName + ' ‚Ä¢ Card√°pio Digital'">Card√°pio Digital Pro</title>
    <meta name="theme-color" content="#ef4444">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-surface font-body transition-colors duration-300" x-cloak>

    <!-- TOAST -->
    <div x-show="toast.visible"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0 translate-y-4"
         x-transition:enter-end="opacity-100 translate-y-0"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100 translate-y-0"
         x-transition:leave-end="opacity-0 translate-y-4"
         class="fixed bottom-6 left-1/2 -translate-x-1/2 z-[100] flex items-center gap-3 px-5 py-3 rounded-2xl shadow-2xl text-white font-medium text-sm"
         :class="toast.type==='success'?'bg-green-500':toast.type==='error'?'bg-red-500':'bg-gray-800'"
         style="min-width:220px">
        <span x-text="toast.icon" class="text-lg"></span>
        <span x-text="toast.message"></span>
    </div>

    <!-- ‚ïê‚ïê‚ïê HEADER ‚ïê‚ïê‚ïê -->
    <header class="sticky top-0 z-40 bg-surface-card border-b border-border backdrop-blur-sm">
        <div class="max-w-2xl mx-auto px-4 py-3 flex justify-between items-center gap-4">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-xl flex items-center justify-center text-white font-display font-bold text-lg flex-shrink-0"
                     :style="`background:var(--accent)`" x-text="config.restaurantName.charAt(0)"></div>
                <div>
                    <h1 class="text-base font-display font-bold text-text-primary leading-tight" x-text="config.restaurantName"></h1>
                    <p class="text-xs flex items-center gap-1.5 font-body"
                       :class="config.isOpen ? 'text-green-500' : 'text-red-400'">
                        <span class="w-1.5 h-1.5 rounded-full inline-block"
                              :class="config.isOpen ? 'bg-green-500 animate-pulse' : 'bg-red-400'"></span>
                        <span x-text="config.isOpen ? 'Aberto agora' : 'Fechado'"></span>
                        <span class="text-text-muted">‚Ä¢</span>
                        <span class="text-text-muted" x-text="config.city"></span>
                    </p>
                </div>
            </div>
            <div class="flex items-center gap-2">
                <button @click="showSearch = !showSearch" class="icon-btn" title="Buscar">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35M17 11A6 6 0 1 1 5 11a6 6 0 0 1 12 0z"/></svg>
                </button>
                <button @click="darkMode = !darkMode; saveSetting('darkMode', darkMode)" class="icon-btn" title="Tema">
                    <svg x-show="!darkMode" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 0 1 8.646 3.646 9.003 9.003 0 0 0 12 21a9.003 9.003 0 0 0 8.354-5.646z"/></svg>
                    <svg x-show="darkMode" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728 0-.707.707M6.343 17.657l-.707.707M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8z"/></svg>
                </button>
                <button @click="showThemePicker = true" class="icon-btn" title="Cores">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 0 1-4-4V5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v12a4 4 0 0 1-4 4zm0 0h12a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 0 1 2.828 0l2.829 2.829a2 2 0 0 1 0 2.828l-8.486 8.485M7 17h.01"/></svg>
                </button>
                <button @click="showAdminLogin = true" class="icon-btn" title="Administrador">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 0 0-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 0 0-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 0 0-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 0 0-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 0 0 1.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><circle cx="12" cy="12" r="3" stroke-width="2"/></svg>
                </button>
                <button @click="showCart = true"
                        class="relative cart-btn flex items-center gap-2 px-3 py-2 rounded-xl font-medium text-sm text-white transition-transform active:scale-95"
                        :style="`background:var(--accent)`">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-8 2a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"/></svg>
                    <span x-show="cartTotalItems > 0" x-text="cartTotalItems" class="font-display font-bold"></span>
                </button>
            </div>
        </div>

        <!-- Search Bar -->
        <div x-show="showSearch"
             x-transition:enter="transition ease-out duration-200"
             x-transition:enter-start="opacity-0 -translate-y-2"
             x-transition:enter-end="opacity-100 translate-y-0"
             class="max-w-2xl mx-auto px-4 pb-3">
            <div class="relative">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-text-muted" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35M17 11A6 6 0 1 1 5 11a6 6 0 0 1 12 0z"/></svg>
                <input type="text" x-model="searchQuery" placeholder="Buscar no card√°pio‚Ä¶"
                       class="w-full pl-9 pr-4 py-2.5 bg-surface-muted rounded-xl text-sm text-text-primary placeholder-text-muted outline-none focus:ring-2 ring-accent transition-all">
                <button x-show="searchQuery" @click="searchQuery=''" class="absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary">‚úï</button>
            </div>
        </div>

        <!-- Category Tabs -->
        <div x-show="!showSearch || !searchQuery" class="flex gap-2 overflow-x-auto px-4 pb-3 hide-scrollbar">
            <button @click="activeTab = null" :class="activeTab===null?'tab-active':'tab-inactive'" class="tab-btn">Todos</button>
            <template x-for="cat in activeCategories" :key="cat.id">
                <button @click="activeTab = cat.id" :class="activeTab===cat.id?'tab-active':'tab-inactive'" class="tab-btn">
                    <span x-text="cat.icon" class="mr-1"></span><span x-text="cat.name"></span>
                </button>
            </template>
        </div>
    </header>

    <!-- PROMO BANNER -->
    <div x-show="activePromos.length > 0 && !searchQuery" class="max-w-2xl mx-auto px-4 pt-4">
        <div class="promo-banner rounded-2xl p-4 flex items-center gap-3 relative overflow-hidden">
            <div class="promo-bg-decoration"></div>
            <div class="text-2xl flex-shrink-0">üî•</div>
            <div class="flex-1 min-w-0">
                <p class="text-xs font-semibold text-white/70 uppercase tracking-wider">Promo√ß√µes Ativas</p>
                <div class="flex gap-2 overflow-x-auto hide-scrollbar mt-1">
                    <template x-for="promo in activePromos" :key="promo.id">
                        <span class="inline-block bg-white/20 text-white text-xs font-medium px-2.5 py-1 rounded-lg whitespace-nowrap">
                            <span x-text="promo.name"></span>
                            <span class="ml-1 font-bold">
                                <span x-show="promo.type==='percentage'">-<span x-text="promo.value"></span>%</span>
                                <span x-show="promo.type==='fixed'">-<span x-text="formatMoney(promo.value)"></span></span>
                                <span x-show="promo.type==='freeDelivery'">Frete gr√°tis!</span>
                            </span>
                        </span>
                    </template>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê MAIN CONTENT ‚ïê‚ïê‚ïê -->
    <main class="max-w-2xl mx-auto px-4 pb-28 pt-4">
        <div x-show="searchQuery" class="mb-4">
            <p class="text-sm text-text-muted"><span x-text="filteredItems.length"></span> resultado(s) para "<span class="text-text-primary font-medium" x-text="searchQuery"></span>"</p>
        </div>
        <div x-show="filteredItems.length === 0" class="flex flex-col items-center justify-center py-20 text-center">
            <div class="text-6xl mb-4">üçΩÔ∏è</div>
            <h3 class="text-lg font-display font-bold text-text-primary mb-2">Nenhum item encontrado</h3>
            <p class="text-sm text-text-muted">Tente outra categoria ou busca diferente.</p>
        </div>
        <div class="space-y-3">
            <template x-for="item in filteredItems" :key="item.id">
                <div class="product-card bg-surface-card rounded-2xl border border-border overflow-hidden flex items-stretch transition-all duration-200 hover:shadow-md hover:border-accent/30 cursor-pointer"
                     @click="openProductModal(item)">
                    <div class="flex-1 p-4 flex flex-col justify-between min-w-0">
                        <div>
                            <div class="flex items-start gap-2 mb-1">
                                <h3 class="font-display font-bold text-text-primary text-sm leading-tight flex-1" x-text="item.name"></h3>
                                <div class="flex flex-col gap-1 items-end flex-shrink-0">
                                    <span x-show="item.featured" class="badge-featured text-[10px] px-2 py-0.5 rounded-full font-bold">‚≠ê Destaque</span>
                                    <span x-show="!item.available" class="bg-gray-200 dark:bg-gray-700 text-text-muted text-[10px] px-2 py-0.5 rounded-full">Indispon√≠vel</span>
                                    <!-- Complement badge -->
                                    <span x-show="item.complements && item.complements.length > 0"
                                          class="text-[10px] px-2 py-0.5 rounded-full font-medium bg-accent/10 text-accent">
                                        + Adicionais
                                    </span>
                                </div>
                            </div>
                            <p class="text-xs text-text-muted line-clamp-2 leading-relaxed" x-text="item.desc"></p>
                        </div>
                        <div class="mt-3 flex justify-between items-center">
                            <div>
                                <div x-show="item.promoPrice" class="flex items-baseline gap-2">
                                    <span class="text-xs text-text-muted line-through" x-text="formatMoney(item.price)"></span>
                                    <span class="font-display font-bold text-accent" x-text="formatMoney(item.promoPrice)"></span>
                                </div>
                                <span x-show="!item.promoPrice" class="font-display font-bold text-accent" x-text="formatMoney(item.price)"></span>
                            </div>
                            <button @click.stop="addToCart(item)"
                                    :disabled="!item.available"
                                    class="add-btn w-8 h-8 rounded-xl flex items-center justify-center text-white font-bold text-lg transition-all active:scale-90 disabled:opacity-40 disabled:cursor-not-allowed"
                                    :style="item.available ? 'background:var(--accent)' : ''">+</button>
                        </div>
                    </div>
                    <div class="w-28 flex-shrink-0 relative">
                        <img :src="item.image || 'https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=300'"
                             :alt="item.name" class="w-full h-full object-cover" style="min-height:110px;max-height:130px">
                        <div x-show="item.promoPrice" class="absolute top-2 left-2 bg-red-500 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-lg">PROMO</div>
                    </div>
                </div>
            </template>
        </div>
    </main>

    <!-- ‚ïê‚ïê‚ïê PRODUCT DETAIL MODAL (with Complements) ‚ïê‚ïê‚ïê -->
    <div x-show="showProductModal && selectedProduct"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         class="fixed inset-0 z-50 flex items-end sm:items-center justify-center">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" @click="showProductModal=false"></div>
        <div x-show="showProductModal && selectedProduct"
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="translate-y-full sm:translate-y-0 sm:scale-95 opacity-0"
             x-transition:enter-end="translate-y-0 sm:scale-100 opacity-100"
             class="relative bg-surface-card w-full max-w-lg rounded-t-3xl sm:rounded-3xl overflow-hidden shadow-2xl max-h-[92vh] flex flex-col">
            <template x-if="selectedProduct">
                <div class="flex flex-col overflow-hidden">
                    <!-- Product Image -->
                    <div class="relative h-48 flex-shrink-0">
                        <img :src="selectedProduct.image" :alt="selectedProduct.name" class="w-full h-full object-cover">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                        <button @click="showProductModal=false" class="absolute top-4 right-4 bg-black/40 text-white rounded-full w-8 h-8 flex items-center justify-center">‚úï</button>
                        <div x-show="selectedProduct.promoPrice" class="absolute top-4 left-4 bg-red-500 text-white text-xs font-bold px-2.5 py-1 rounded-xl">üî• PROMO√á√ÉO</div>
                        <div class="absolute bottom-4 left-4">
                            <h2 class="text-xl font-display font-bold text-white" x-text="selectedProduct.name"></h2>
                        </div>
                    </div>

                    <!-- Scrollable content -->
                    <div class="p-5 overflow-y-auto flex-1 space-y-4">
                        <p class="text-sm text-text-muted leading-relaxed" x-text="selectedProduct.desc"></p>

                        <!-- Price & Qty -->
                        <div class="flex items-center justify-between">
                            <div>
                                <div x-show="selectedProduct.promoPrice" class="flex items-baseline gap-2">
                                    <span class="text-sm text-text-muted line-through" x-text="formatMoney(selectedProduct.price)"></span>
                                    <span class="text-2xl font-display font-bold text-accent" x-text="formatMoney(selectedProduct.promoPrice)"></span>
                                </div>
                                <span x-show="!selectedProduct.promoPrice" class="text-2xl font-display font-bold text-accent" x-text="formatMoney(selectedProduct.price)"></span>
                            </div>
                            <div class="flex items-center gap-3 bg-surface-muted rounded-xl p-1">
                                <button @click="if(modalQty>1) modalQty--" class="w-8 h-8 rounded-lg bg-surface-card flex items-center justify-center font-bold text-text-primary shadow-sm">‚àí</button>
                                <span x-text="modalQty" class="font-display font-bold text-text-primary w-6 text-center"></span>
                                <button @click="modalQty++" class="w-8 h-8 rounded-xl flex items-center justify-center text-white font-bold shadow-sm" :style="'background:var(--accent)'">+</button>
                            </div>
                        </div>

                        <!-- ‚ïê‚ïê‚ïê COMPLEMENT GROUPS ‚ïê‚ïê‚ïê -->
                        <template x-if="selectedProduct.complements && selectedProduct.complements.length > 0">
                            <div class="space-y-4">
                                <template x-for="group in selectedProduct.complements" :key="group.id">
                                    <div class="complement-group rounded-2xl border border-border overflow-hidden">
                                        <!-- Group Header -->
                                        <div class="flex items-center justify-between px-4 py-3 bg-surface-muted border-b border-border">
                                            <div>
                                                <h4 class="font-display font-bold text-text-primary text-sm" x-text="group.name"></h4>
                                                <p class="text-xs text-text-muted mt-0.5">
                                                    <span x-show="group.required" class="text-accent font-medium">Obrigat√≥rio</span>
                                                    <span x-show="!group.required" class="text-text-muted">Opcional</span>
                                                    <span x-show="group.type==='multiple'"> ‚Ä¢ At√© <span x-text="group.max"></span> op√ß√£o(√µes)</span>
                                                    <span x-show="group.type==='single'"> ‚Ä¢ Escolha 1</span>
                                                </p>
                                            </div>
                                            <!-- Selection counter -->
                                            <span class="text-xs font-bold rounded-full px-2 py-1 transition-colors"
                                                  :class="(modalSelectedComplements[group.id]||[]).length > 0 ? 'bg-accent/10 text-accent' : 'bg-surface-card text-text-muted'">
                                                <span x-text="(modalSelectedComplements[group.id]||[]).length"></span>/<span x-text="group.type==='single'?1:group.max"></span>
                                            </span>
                                        </div>
                                        <!-- Options -->
                                        <div class="divide-y divide-border">
                                            <template x-for="option in group.options" :key="option.id">
                                                <button @click="toggleComplement(group, option)"
                                                        class="complement-option w-full flex items-center gap-3 px-4 py-3 hover:bg-surface-muted transition-colors text-left"
                                                        :class="isComplementSelected(group.id, option.id) ? 'bg-accent/5 border-l-2 border-accent' : ''">
                                                    <!-- Checkbox/Radio indicator -->
                                                    <div class="w-5 h-5 rounded flex items-center justify-center flex-shrink-0 transition-all border-2"
                                                         :class="isComplementSelected(group.id, option.id)
                                                           ? 'border-transparent text-white'
                                                           : 'border-border bg-surface-card'"
                                                         :style="isComplementSelected(group.id, option.id) ? 'background:var(--accent)' : ''"
                                                         :style="group.type==='single' ? 'border-radius:50%' : 'border-radius:5px'"
                                                         style="">
                                                        <svg x-show="isComplementSelected(group.id, option.id)" class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/></svg>
                                                    </div>
                                                    <span class="flex-1 text-sm text-text-primary font-medium" x-text="option.name"></span>
                                                    <span class="text-sm font-bold flex-shrink-0"
                                                          :class="option.price > 0 ? 'text-accent' : 'text-text-muted'">
                                                        <span x-show="option.price > 0">+<span x-text="formatMoney(option.price)"></span></span>
                                                        <span x-show="option.price === 0" class="text-text-muted text-xs">Gr√°tis</span>
                                                    </span>
                                                </button>
                                            </template>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </template>

                        <!-- Notes -->
                        <div>
                            <label class="form-label mb-2">Observa√ß√µes (opcional)</label>
                            <textarea x-model="modalNote" placeholder="Ex: sem cebola, ponto bem passado, tirar o molho‚Ä¶" rows="2"
                                      class="w-full text-sm bg-surface-muted text-text-primary placeholder-text-muted rounded-xl p-3 outline-none focus:ring-2 ring-accent resize-none transition-all"></textarea>
                        </div>

                        <!-- Complements Summary -->
                        <div x-show="modalComplementsTotal > 0" class="complement-summary rounded-xl p-3 flex items-center justify-between text-sm">
                            <span class="text-text-muted">Adicionais selecionados</span>
                            <span class="font-bold text-accent">+<span x-text="formatMoney(modalComplementsTotal)"></span></span>
                        </div>

                        <!-- Add Button -->
                        <button @click="confirmAddToCart()"
                                :disabled="!selectedProduct.available"
                                class="w-full py-3.5 rounded-2xl text-white font-display font-bold text-base shadow-lg transition-all active:scale-[0.98] disabled:opacity-50"
                                :style="'background:var(--accent)'">
                            <span x-show="selectedProduct.available">
                                Adicionar ‚Ä¢ <span x-text="formatMoney(((selectedProduct.promoPrice||selectedProduct.price) + modalComplementsTotal) * modalQty)"></span>
                            </span>
                            <span x-show="!selectedProduct.available">Item Indispon√≠vel</span>
                        </button>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê CART PANEL ‚ïê‚ïê‚ïê -->
    <div x-show="showCart"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         class="fixed inset-0 z-50 flex items-end sm:items-center justify-center">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" @click="showCart=false"></div>
        <div x-show="showCart"
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="translate-y-full sm:translate-y-0 sm:scale-95 opacity-0"
             x-transition:enter-end="translate-y-0 sm:scale-100 opacity-100"
             class="relative bg-surface-card w-full max-w-lg rounded-t-3xl sm:rounded-3xl shadow-2xl flex flex-col max-h-[92vh]">
            <div class="flex justify-between items-center p-5 border-b border-border flex-shrink-0">
                <div>
                    <h2 class="text-xl font-display font-bold text-text-primary">Seu Pedido</h2>
                    <p class="text-xs text-text-muted mt-0.5" x-show="cart.length > 0">
                        <span x-text="cartTotalItems"></span> item(s) ‚Ä¢ <span x-text="formatMoney(cartSubtotal)"></span>
                    </p>
                </div>
                <button @click="showCart=false" class="icon-btn">‚úï</button>
            </div>

            <div class="overflow-y-auto flex-1 p-5 space-y-3">
                <template x-for="(item, index) in cart" :key="index">
                    <div class="flex items-start gap-3 bg-surface-muted rounded-2xl p-3">
                        <img :src="item.image" class="w-14 h-14 rounded-xl object-cover flex-shrink-0">
                        <div class="flex-1 min-w-0">
                            <p class="font-display font-bold text-text-primary text-sm leading-tight" x-text="item.name"></p>
                            <!-- Complements list in cart -->
                            <template x-if="item.complements && item.complements.length > 0">
                                <div class="mt-1 flex flex-wrap gap-1">
                                    <template x-for="comp in item.complements" :key="comp.optionId">
                                        <span class="text-[10px] bg-accent/10 text-accent px-1.5 py-0.5 rounded-md font-medium">
                                            <span x-text="comp.optionName"></span>
                                            <span x-show="comp.price > 0" class="opacity-75"> +<span x-text="formatMoney(comp.price)"></span></span>
                                        </span>
                                    </template>
                                </div>
                            </template>
                            <p x-show="item.note" class="text-xs text-text-muted italic mt-1 truncate" x-text="'üìù ' + item.note"></p>
                            <p class="text-accent font-bold text-sm mt-1"
                               x-text="formatMoney(((item.promoPrice||item.price) + (item.complements||[]).reduce((s,c)=>s+c.price,0)) * item.qty)"></p>
                        </div>
                        <div class="flex items-center gap-2 flex-shrink-0">
                            <button @click="decrementCart(index)" class="w-7 h-7 rounded-lg bg-surface-card border border-border flex items-center justify-center text-text-primary font-bold text-sm">‚àí</button>
                            <span x-text="item.qty" class="font-display font-bold text-text-primary w-5 text-center text-sm"></span>
                            <button @click="incrementCart(index)" class="w-7 h-7 rounded-xl flex items-center justify-center text-white font-bold text-sm" :style="'background:var(--accent)'">+</button>
                        </div>
                    </div>
                </template>

                <div x-show="cart.length === 0" class="flex flex-col items-center justify-center py-12 text-center">
                    <div class="text-5xl mb-3">üõí</div>
                    <h3 class="font-display font-bold text-text-primary mb-1">Carrinho vazio</h3>
                    <p class="text-sm text-text-muted">Adicione items do card√°pio para come√ßar</p>
                </div>

                <!-- Checkout Form -->
                <div x-show="cart.length > 0" class="space-y-3 pt-3">
                    <div class="border-t border-dashed border-border pt-4">
                        <h3 class="font-display font-bold text-text-primary mb-3 text-sm uppercase tracking-wider">Dados de Entrega</h3>
                        <div class="space-y-2.5">
                            <input type="text" x-model="checkout.name" placeholder="Seu nome completo *" class="form-input w-full">
                            <input type="tel" x-model="checkout.phone" placeholder="WhatsApp (11) 99999-9999 *" class="form-input w-full">
                            <div class="grid grid-cols-2 gap-2">
                                <button @click="checkout.deliveryType='delivery'"
                                        :class="checkout.deliveryType==='delivery'?'border-accent bg-accent/10 text-accent':'border-border text-text-muted'"
                                        class="py-2.5 rounded-xl border-2 font-medium text-sm transition-all">üõµ Delivery</button>
                                <button @click="checkout.deliveryType='pickup'"
                                        :class="checkout.deliveryType==='pickup'?'border-accent bg-accent/10 text-accent':'border-border text-text-muted'"
                                        class="py-2.5 rounded-xl border-2 font-medium text-sm transition-all">üèÉ Retirada</button>
                            </div>
                            <div x-show="checkout.deliveryType==='delivery'">
                                <input type="text" x-model="checkout.address" placeholder="Rua, n√∫mero, bairro *" class="form-input w-full mb-2">
                                <input type="text" x-model="checkout.complement" placeholder="Complemento (apto, ref.)" class="form-input w-full">
                            </div>
                            <div>
                                <p class="text-xs text-text-muted font-medium mb-2 uppercase tracking-wider">Forma de Pagamento</p>
                                <div class="grid grid-cols-3 gap-2">
                                    <template x-for="method in paymentMethods" :key="method.id">
                                        <button @click="checkout.payment=method.id"
                                                :class="checkout.payment===method.id?'border-accent bg-accent/10':'border-border'"
                                                class="flex flex-col items-center gap-1 py-2.5 rounded-xl border-2 transition-all">
                                            <span class="text-xl" x-text="method.icon"></span>
                                            <span class="text-[11px] font-medium" :class="checkout.payment===method.id?'text-accent':'text-text-muted'" x-text="method.name"></span>
                                        </button>
                                    </template>
                                </div>
                            </div>
                            <div class="flex gap-2">
                                <input type="text" x-model="couponInput" placeholder="Cupom de desconto" class="form-input flex-1 uppercase">
                                <button @click="applyCoupon()" class="px-4 py-2.5 rounded-xl font-medium text-sm text-white" :style="'background:var(--accent)'">Aplicar</button>
                            </div>
                            <div x-show="appliedCoupon" class="flex items-center gap-2 bg-green-500/10 border border-green-500/20 rounded-xl p-3">
                                <span class="text-green-500 font-bold text-sm">‚úì Cupom "<span x-text="appliedCoupon?.code" class="uppercase"></span>" aplicado!</span>
                                <button @click="appliedCoupon=null" class="ml-auto text-text-muted text-xs">Remover</button>
                            </div>
                        </div>
                    </div>

                    <!-- Order Summary -->
                    <div class="bg-surface-muted rounded-2xl p-4 space-y-2 text-sm">
                        <div class="flex justify-between text-text-muted"><span>Subtotal</span><span x-text="formatMoney(cartSubtotal)"></span></div>
                        <div x-show="discountValue > 0" class="flex justify-between text-green-500"><span>Desconto</span><span>-<span x-text="formatMoney(discountValue)"></span></span></div>
                        <div class="flex justify-between text-text-muted" x-show="checkout.deliveryType==='delivery'">
                            <span>Taxa de entrega</span>
                            <span x-show="deliveryFee===0" class="text-green-500 font-medium">Gr√°tis üéâ</span>
                            <span x-show="deliveryFee>0" x-text="formatMoney(deliveryFee)"></span>
                        </div>
                        <div class="border-t border-border pt-2 flex justify-between font-display font-bold text-base text-text-primary">
                            <span>Total</span><span class="text-accent" x-text="formatMoney(orderTotal)"></span>
                        </div>
                    </div>
                </div>
            </div>

            <div x-show="cart.length > 0" class="p-5 border-t border-border flex-shrink-0">
                <button @click="sendToWhatsApp()"
                        class="w-full py-4 rounded-2xl text-white font-display font-bold text-base shadow-lg shadow-green-500/20 bg-green-500 hover:bg-green-600 flex items-center justify-center gap-2.5 transition-all active:scale-[0.98]">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 0 1-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 0 1-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 0 1 2.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0 0 12.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 0 0 5.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 0 0-3.48-8.413z"/></svg>
                    Enviar Pedido via WhatsApp
                </button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê PIX MODAL ‚ïê‚ïê‚ïê -->
    <div x-show="showPixModal" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" class="fixed inset-0 z-50 flex items-end sm:items-center justify-center">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-sm"></div>
        <div x-show="showPixModal" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="translate-y-full sm:scale-95 opacity-0" x-transition:enter-end="translate-y-0 sm:scale-100 opacity-100"
             class="relative bg-surface-card w-full max-w-md rounded-t-3xl sm:rounded-3xl shadow-2xl overflow-hidden">
            <div x-show="pixStatus==='confirmed'" class="p-10 text-center"><div class="text-6xl mb-4 animate-bounce">‚úÖ</div><h3 class="font-display font-bold text-text-primary text-2xl mb-2">Pagamento Confirmado!</h3><p class="text-text-muted text-sm">Seu pedido est√° sendo preparado üçî</p></div>
            <div x-show="pixStatus==='expired'" class="p-8 text-center"><div class="text-5xl mb-4">‚è∞</div><h3 class="font-display font-bold text-text-primary text-xl mb-2">QR Code Expirado</h3><p class="text-text-muted text-sm mb-4">O tempo limite expirou.</p><button @click="openPixModal()" class="btn-primary">Gerar Novo QR Code</button><button @click="showPixModal=false;showCart=true" class="w-full mt-2 py-2 text-sm text-text-muted">Voltar ao carrinho</button></div>
            <div x-show="pixStatus==='pending'" class="p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 rounded-xl flex items-center justify-center text-white text-lg font-bold" :style="'background:var(--accent)'">üîë</div>
                    <div><h3 class="font-display font-bold text-text-primary text-lg">Pague via PIX</h3><p class="text-xs text-text-muted">Escaneie o QR Code ou copie a chave</p></div>
                    <div class="ml-auto text-right"><div class="font-display font-bold text-2xl text-accent" x-text="formatMoney(orderTotal)"></div><div class="text-xs font-mono" :class="pixCountdown<60?'text-red-500':'text-text-muted'">Expira em <span x-text="pixCountdownFormatted"></span></div></div>
                </div>
                <div class="w-full h-1.5 bg-surface-muted rounded-full mb-4 overflow-hidden"><div class="h-full rounded-full transition-all duration-1000" :style="`width:${(pixCountdown/300)*100}%;background:var(--accent)`" :class="pixCountdown<60?'!bg-red-500':''"></div></div>
                <div class="flex flex-col items-center mb-4"><div class="bg-white p-3 rounded-2xl shadow-sm border border-border inline-block"><img :src="pixQrUrl" alt="QR Code PIX" class="w-44 h-44 rounded-xl" loading="lazy"></div><p class="text-xs text-text-muted text-center mt-2">Aponte a c√¢mera do celular para o c√≥digo</p></div>
                <div class="bg-surface-muted rounded-2xl p-4 mb-4"><p class="text-xs text-text-muted uppercase tracking-wider font-medium mb-2">Chave PIX</p><div class="flex items-center gap-3"><span class="font-mono text-sm text-text-primary flex-1 break-all" x-text="config.pixKey"></span><button @click="copyPixKey()" class="flex-shrink-0 px-3 py-2 rounded-xl font-medium text-sm transition-all" :class="pixCopied?'bg-green-500 text-white':''" :style="!pixCopied?'background:var(--accent);color:white':''"><span x-show="!pixCopied">üìã Copiar</span><span x-show="pixCopied">‚úì Copiado!</span></button></div></div>
                <div class="space-y-2 mb-4">
                    <div class="flex items-center gap-3 text-sm text-text-secondary"><span class="w-6 h-6 rounded-full bg-surface-muted flex items-center justify-center text-xs font-bold text-accent flex-shrink-0">1</span>Abra o app do banco e escolha <strong>Pagar com PIX</strong></div>
                    <div class="flex items-center gap-3 text-sm text-text-secondary"><span class="w-6 h-6 rounded-full bg-surface-muted flex items-center justify-center text-xs font-bold text-accent flex-shrink-0">2</span>Escaneie o QR Code ou cole a chave PIX</div>
                    <div class="flex items-center gap-3 text-sm text-text-secondary"><span class="w-6 h-6 rounded-full bg-surface-muted flex items-center justify-center text-xs font-bold text-accent flex-shrink-0">3</span>Confirme o valor de <strong x-text="formatMoney(orderTotal)"></strong> e pague</div>
                    <div class="flex items-center gap-3 text-sm text-text-secondary"><span class="w-6 h-6 rounded-full bg-surface-muted flex items-center justify-center text-xs font-bold text-accent flex-shrink-0">4</span>Clique em <strong>"J√° Paguei"</strong> abaixo</div>
                </div>
                <button @click="confirmPixPayment()" class="w-full py-4 rounded-2xl font-display font-bold text-base text-white shadow-lg transition-all active:scale-[0.98]" :style="'background:var(--accent)'">‚úÖ J√° Paguei ‚Äî Confirmar Pedido</button>
                <button @click="showPixModal=false;showCart=true" class="w-full mt-2 py-2 text-sm text-text-muted hover:text-text-primary transition-colors">‚Üê Voltar ao carrinho</button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê THEME PICKER ‚ïê‚ïê‚ïê -->
    <div x-show="showThemePicker" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" class="fixed inset-0 z-50 flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" @click="showThemePicker=false"></div>
        <div class="relative bg-surface-card rounded-3xl shadow-2xl p-6 w-full max-w-sm" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="scale-95 opacity-0" x-transition:enter-end="scale-100 opacity-100">
            <h3 class="font-display font-bold text-text-primary text-lg mb-4">üé® Tema e Cores</h3>
            <p class="text-xs font-medium text-text-muted uppercase tracking-wider mb-3">Paletas</p>
            <div class="grid grid-cols-4 gap-3 mb-5">
                <template x-for="theme in themes" :key="theme.id">
                    <button @click="setTheme(theme)" class="flex flex-col items-center gap-1.5 p-2 rounded-2xl border-2 transition-all" :class="currentTheme.id===theme.id?'border-accent':'border-transparent hover:border-border'">
                        <div class="w-10 h-10 rounded-xl shadow-sm" :style="`background:${theme.accent}`"></div>
                        <span class="text-[10px] font-medium text-text-muted" x-text="theme.name"></span>
                    </button>
                </template>
            </div>
            <p class="text-xs font-medium text-text-muted uppercase tracking-wider mb-3">Cor personalizada</p>
            <div class="flex gap-3 items-center mb-5">
                <input type="color" x-model="customAccent" @input="applyCustomColor($event.target.value)" class="w-12 h-12 rounded-xl cursor-pointer border-2 border-border bg-transparent p-1">
                <div><p class="text-sm font-medium text-text-primary" x-text="customAccent.toUpperCase()"></p><p class="text-xs text-text-muted">Clique para escolher</p></div>
            </div>
            <div class="flex items-center justify-between bg-surface-muted rounded-2xl p-4 mb-4">
                <div><p class="font-medium text-text-primary text-sm">Modo Escuro</p><p class="text-xs text-text-muted">Interface dark</p></div>
                <button @click="darkMode=!darkMode;saveSetting('darkMode',darkMode)" class="relative w-12 h-6 rounded-full transition-colors duration-300 flex-shrink-0" :style="darkMode?'background:var(--accent)':'background:#d1d5db'">
                    <div class="absolute top-0.5 w-5 h-5 bg-white rounded-full shadow transition-transform duration-300" :class="darkMode?'translate-x-6':'translate-x-0.5'"></div>
                </button>
            </div>
            <button @click="showThemePicker=false" class="w-full py-3 rounded-2xl font-bold text-white" :style="'background:var(--accent)'">Pronto</button>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê ADMIN LOGIN MODAL ‚ïê‚ïê‚ïê -->
    <div x-show="showAdminLogin && !isAdmin" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" class="fixed inset-0 z-50 flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" @click="showAdminLogin=false"></div>
        <div class="relative bg-surface-card rounded-3xl shadow-2xl p-6 w-full max-w-sm" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="scale-95 opacity-0" x-transition:enter-end="scale-100 opacity-100">
            <h3 class="font-display font-bold text-text-primary text-xl mb-1">üîí √Årea Admin</h3>
            <p class="text-sm text-text-muted mb-5">Acesso restrito ao propriet√°rio</p>

            <!-- Lockout Warning -->
            <div x-show="isLockedOut" class="lockout-banner rounded-xl p-3 mb-4">
                <div class="flex items-center gap-2">
                    <span class="text-xl">üîê</span>
                    <div>
                        <p class="text-sm font-bold text-red-600 dark:text-red-400">Conta bloqueada</p>
                        <p class="text-xs text-red-500">Aguarde <span x-text="lockoutRemainingFormatted" class="font-mono font-bold"></span> para tentar novamente</p>
                    </div>
                </div>
            </div>

            <!-- Attempts warning -->
            <div x-show="failedAttempts > 0 && !isLockedOut" class="bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-3 mb-4">
                <p class="text-xs text-yellow-600 dark:text-yellow-400">‚ö†Ô∏è <span x-text="SECURITY_MAX_ATTEMPTS - failedAttempts"></span> tentativa(s) restante(s) antes do bloqueio</p>
            </div>

            <input type="password" x-model="adminPassword" placeholder="Senha de acesso"
                   @keyup.enter="loginAdmin()"
                   :disabled="isLockedOut"
                   class="form-input w-full mb-3" :class="isLockedOut?'opacity-50 cursor-not-allowed':''">
            <p x-show="adminError" class="text-red-500 text-xs mb-3" x-text="adminError"></p>
            <button @click="loginAdmin()" :disabled="isLockedOut" class="w-full py-3 rounded-2xl font-bold text-white disabled:opacity-50 disabled:cursor-not-allowed" :style="'background:var(--accent)'">Entrar</button>
            <p class="text-center text-xs text-text-muted mt-3">Senha padr√£o: <code class="bg-surface-muted px-1 rounded">admin123</code></p>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê ADMIN PANEL ‚ïê‚ïê‚ïê -->
    <div x-show="isAdmin && showAdminPanel" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" class="fixed inset-0 z-50 bg-surface overflow-y-auto">

        <!-- Admin Header -->
        <div class="sticky top-0 bg-surface-card border-b border-border z-10">
            <div class="max-w-3xl mx-auto px-4 py-4 flex items-center justify-between">
                <div>
                    <h1 class="font-display font-bold text-text-primary text-lg">‚öôÔ∏è Painel Admin</h1>
                    <!-- Session indicator -->
                    <div class="flex items-center gap-2 mt-0.5">
                        <span class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></span>
                        <p class="text-xs text-text-muted">Sess√£o expira em <span class="font-mono text-green-500 font-bold" x-text="sessionCountdownLabel"></span></p>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <button @click="tutorialStep=0;showTutorial=true" class="text-xs text-accent hover:text-accent/80 px-3 py-1.5 rounded-lg bg-accent/10 transition-colors font-medium">‚ùì Tutorial</button>
                    <button @click="logoutAdmin()" class="text-xs text-text-muted hover:text-red-500 px-3 py-1.5 rounded-lg bg-surface-muted transition-colors">üîí Sair</button>
                    <button @click="showAdminPanel=false" class="icon-btn">‚úï</button>
                </div>
            </div>
            <div class="flex gap-2 px-4 pb-3 overflow-x-auto hide-scrollbar">
                <template x-for="tab in adminTabs" :key="tab.id">
                    <button @click="adminTab=tab.id" :class="adminTab===tab.id?'tab-active':'tab-inactive'" class="tab-btn">
                        <span x-text="tab.icon" class="mr-1"></span><span x-text="tab.name"></span>
                    </button>
                </template>
            </div>
        </div>

        <div class="max-w-3xl mx-auto px-4 py-5 pb-24 space-y-5">

            <!-- ‚îÄ‚îÄ STORE SETTINGS ‚îÄ‚îÄ -->
            <div x-show="adminTab==='store'" class="space-y-4">
                <h2 class="admin-section-title">üìã Dados da Loja</h2>
                <div class="admin-card space-y-3">
                    <div class="grid grid-cols-2 gap-3">
                        <div class="col-span-2"><label class="form-label">Nome do Restaurante</label><input type="text" x-model="config.restaurantName" class="form-input w-full"></div>
                        <div><label class="form-label">Cidade</label><input type="text" x-model="config.city" class="form-input w-full"></div>
                        <div><label class="form-label">WhatsApp (com DDD)</label><input type="text" x-model="config.whatsapp" placeholder="5582999999999" class="form-input w-full"></div>
                        <div class="col-span-2"><label class="form-label">Chave PIX</label><input type="text" x-model="config.pixKey" class="form-input w-full"></div>
                        <div><label class="form-label">Taxa de Entrega (R$)</label><input type="number" x-model.number="config.deliveryFee" step="0.50" class="form-input w-full"></div>
                        <div><label class="form-label">Pedido m√≠nimo (R$)</label><input type="number" x-model.number="config.minOrder" class="form-input w-full"></div>
                        <div class="col-span-2"><label class="form-label">Tempo de entrega</label><input type="text" x-model="config.deliveryTime" class="form-input w-full"></div>
                    </div>

                    <!-- Security: Change Password -->
                    <div class="border-t border-border pt-3">
                        <h3 class="text-xs font-bold text-text-muted uppercase tracking-wider mb-2">üîê Seguran√ßa</h3>
                        <div class="grid grid-cols-2 gap-2">
                            <div class="col-span-2"><label class="form-label">Nova Senha Admin</label><input type="password" x-model="config.adminPass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" class="form-input w-full"></div>
                        </div>
                        <p class="text-xs text-text-muted mt-1.5">‚ö†Ô∏è M√≠nimo 8 caracteres recomendado. Nunca compartilhe sua senha.</p>
                    </div>

                    <div class="flex items-center justify-between bg-surface-muted rounded-xl p-3">
                        <div><p class="font-medium text-text-primary text-sm">Loja Aberta</p><p class="text-xs text-text-muted">Ative para receber pedidos</p></div>
                        <button @click="config.isOpen=!config.isOpen" class="relative w-12 h-6 rounded-full transition-colors duration-300" :style="config.isOpen?'background:var(--accent)':'background:#d1d5db'">
                            <div class="absolute top-0.5 w-5 h-5 bg-white rounded-full shadow transition-transform duration-300" :class="config.isOpen?'translate-x-6':'translate-x-0.5'"></div>
                        </button>
                    </div>
                    <button @click="saveConfig()" class="btn-primary w-full">üíæ Salvar Configura√ß√µes</button>
                </div>
            </div>

            <!-- ‚îÄ‚îÄ CATEGORIES ‚îÄ‚îÄ -->
            <div x-show="adminTab==='categories'" class="space-y-4">
                <h2 class="admin-section-title">üè∑Ô∏è Categorias</h2>
                <div class="admin-card">
                    <h3 class="font-display font-bold text-text-primary mb-3 text-sm">Adicionar Categoria</h3>
                    <div class="grid grid-cols-3 gap-2 mb-3">
                        <input type="text" x-model="newCategory.name" placeholder="Nome *" class="form-input col-span-2">
                        <input type="text" x-model="newCategory.icon" placeholder="üçî Emoji" class="form-input">
                    </div>
                    <button @click="addCategory()" class="btn-primary w-full">+ Adicionar Categoria</button>
                </div>
                <div class="space-y-2">
                    <template x-for="(cat, idx) in categories" :key="cat.id">
                        <div class="admin-card flex items-center justify-between gap-3">
                            <div class="flex items-center gap-3">
                                <span class="text-2xl" x-text="cat.icon||'üì¶'"></span>
                                <div>
                                    <p class="font-bold text-text-primary" x-text="cat.name"></p>
                                    <p class="text-xs text-text-muted"><span x-text="items.filter(i=>i.category===cat.id).length"></span> item(s)</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-2">
                                <button @click="cat.active=!cat.active" class="text-xs px-2 py-1 rounded-lg transition-colors" :class="cat.active?'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400':'bg-gray-100 text-gray-500 dark:bg-gray-800'" x-text="cat.active?'Ativa':'Inativa'"></button>
                                <button @click="deleteCategory(idx)" class="text-red-400 hover:text-red-600 text-sm px-2 py-1 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20">üóëÔ∏è</button>
                            </div>
                        </div>
                    </template>
                </div>
            </div>

            <!-- ‚îÄ‚îÄ PRODUCTS ‚îÄ‚îÄ -->
            <div x-show="adminTab==='products'" class="space-y-4">
                <div class="flex items-center justify-between">
                    <h2 class="admin-section-title">üõçÔ∏è Produtos</h2>
                    <button @click="openProductForm(null)" class="btn-primary text-sm px-4 py-2">+ Novo Produto</button>
                </div>
                <div class="space-y-2">
                    <template x-for="(item, idx) in items" :key="item.id">
                        <div class="admin-card flex items-center gap-3">
                            <img :src="item.image||'https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=100'" class="w-14 h-14 rounded-xl object-cover flex-shrink-0">
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center gap-2 flex-wrap">
                                    <p class="font-bold text-text-primary text-sm truncate" x-text="item.name"></p>
                                    <span x-show="!item.available" class="text-[10px] bg-red-100 text-red-600 px-1.5 py-0.5 rounded dark:bg-red-900/30">Indisp.</span>
                                    <span x-show="item.featured" class="text-[10px] bg-yellow-100 text-yellow-700 px-1.5 py-0.5 rounded dark:bg-yellow-900/30">‚òÖ</span>
                                    <span x-show="item.complements && item.complements.length > 0" class="text-[10px] bg-purple-100 text-purple-700 px-1.5 py-0.5 rounded dark:bg-purple-900/30">
                                        <span x-text="item.complements.length"></span> grupo(s)
                                    </span>
                                </div>
                                <p class="text-xs text-text-muted" x-text="getCategoryName(item.category)"></p>
                                <div class="flex items-baseline gap-2 mt-1">
                                    <span class="text-accent font-bold text-sm" x-text="formatMoney(item.promoPrice||item.price)"></span>
                                    <span x-show="item.promoPrice" class="text-xs text-text-muted line-through" x-text="formatMoney(item.price)"></span>
                                </div>
                            </div>
                            <div class="flex flex-col gap-1.5">
                                <button @click="openProductForm(item)" class="text-xs px-3 py-1.5 bg-surface-muted rounded-lg text-text-primary hover:bg-accent/10 hover:text-accent transition-colors">‚úèÔ∏è</button>
                                <button @click="deleteProduct(idx)" class="text-xs px-3 py-1.5 bg-surface-muted rounded-lg text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors">üóëÔ∏è</button>
                            </div>
                        </div>
                    </template>
                </div>
            </div>

            <!-- ‚îÄ‚îÄ PROMOTIONS ‚îÄ‚îÄ -->
            <div x-show="adminTab==='promos'" class="space-y-4">
                <h2 class="admin-section-title">üî• Promo√ß√µes</h2>
                <div class="admin-card space-y-3">
                    <h3 class="font-display font-bold text-text-primary text-sm mb-1">Nova Promo√ß√£o</h3>
                    <div class="grid grid-cols-2 gap-2">
                        <input type="text" x-model="newPromo.name" placeholder="Nome *" class="form-input col-span-2">
                        <select x-model="newPromo.type" class="form-input"><option value="percentage">% Desconto</option><option value="fixed">R$ Desconto</option><option value="freeDelivery">Frete Gr√°tis</option><option value="coupon">Cupom</option></select>
                        <input x-show="newPromo.type!=='freeDelivery'" type="number" x-model.number="newPromo.value" :placeholder="newPromo.type==='percentage'?'10 (%)':'5.00 (R$)'" class="form-input">
                        <input x-show="newPromo.type==='coupon'" type="text" x-model="newPromo.code" placeholder="C√≥digo do cupom" class="form-input col-span-2 uppercase">
                        <input type="number" x-model.number="newPromo.minOrder" placeholder="Pedido m√≠nimo R$" class="form-input">
                        <input type="date" x-model="newPromo.expiresAt" class="form-input">
                    </div>
                    <button @click="addPromo()" class="btn-primary w-full">+ Criar Promo√ß√£o</button>
                </div>
                <div class="space-y-2">
                    <template x-for="(promo, idx) in promotions" :key="promo.id">
                        <div class="admin-card flex items-center justify-between gap-3" :class="!promo.active?'opacity-60':''">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-xl flex items-center justify-center text-xl" :style="promo.active?'background:var(--accent-light)':'background:#f3f4f6'">
                                    <span x-show="promo.type==='percentage'">%</span><span x-show="promo.type==='fixed'">R$</span><span x-show="promo.type==='freeDelivery'">üõµ</span><span x-show="promo.type==='coupon'">üéüÔ∏è</span>
                                </div>
                                <div>
                                    <p class="font-bold text-text-primary text-sm" x-text="promo.name"></p>
                                    <p class="text-xs text-text-muted">
                                        <span x-show="promo.type==='percentage'" x-text="promo.value+'% off'"></span>
                                        <span x-show="promo.type==='fixed'" x-text="'-'+formatMoney(promo.value)"></span>
                                        <span x-show="promo.type==='freeDelivery'">Frete gr√°tis</span>
                                        <span x-show="promo.type==='coupon'" x-text="'Cupom: '+promo.code?.toUpperCase()"></span>
                                        <span x-show="promo.minOrder>0"> ‚Ä¢ Min: <span x-text="formatMoney(promo.minOrder)"></span></span>
                                    </p>
                                </div>
                            </div>
                            <div class="flex items-center gap-2">
                                <button @click="promo.active=!promo.active" class="relative w-10 h-5 rounded-full transition-colors duration-300 flex-shrink-0" :style="promo.active?'background:var(--accent)':'background:#d1d5db'"><div class="absolute top-0.5 w-4 h-4 bg-white rounded-full shadow transition-transform duration-300" :class="promo.active?'translate-x-5':'translate-x-0.5'"></div></button>
                                <button @click="deletePromo(idx)" class="text-red-400 hover:text-red-600 px-2 py-1 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 text-sm">üóëÔ∏è</button>
                            </div>
                        </div>
                    </template>
                </div>
            </div>

            <!-- ‚îÄ‚îÄ ORDERS ‚îÄ‚îÄ -->
            <div x-show="adminTab==='orders'" class="space-y-4">
                <div class="flex items-center justify-between">
                    <h2 class="admin-section-title">üìã Hist√≥rico de Pedidos</h2>
                    <button @click="orderHistory=[]; localStorage.removeItem('orderHistory'); addAudit('HISTORY_CLEARED', {})" class="text-xs text-red-400 hover:text-red-600">Limpar</button>
                </div>
                <div class="space-y-3">
                    <template x-for="order in orderHistory.slice().reverse()" :key="order.uuid||order.id">
                        <div class="admin-card">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <div class="flex items-center gap-2 flex-wrap">
                                        <p class="font-bold text-text-primary text-sm" x-text="order.name"></p>
                                        <span x-show="order.orderNumber" class="text-[10px] font-mono bg-surface-muted text-text-muted px-1.5 py-0.5 rounded" x-text="'#'+order.orderNumber"></span>
                                        <!-- Integrity badge -->
                                        <span x-show="order.hash"
                                              class="text-[10px] px-1.5 py-0.5 rounded font-bold"
                                              :class="verifyOrderHash(order) ? 'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400' : 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400'">
                                            <span x-show="verifyOrderHash(order)">‚úì √≠ntegro</span>
                                            <span x-show="!verifyOrderHash(order)">‚ö† adulterado</span>
                                        </span>
                                    </div>
                                    <p class="text-xs text-text-muted" x-text="order.address"></p>
                                    <p class="text-xs text-text-muted font-mono" x-text="(order.date||'') + ' ' + (order.time||'')"></p>
                                </div>
                                <div class="text-right">
                                    <p class="font-bold text-accent" x-text="formatMoney(order.total)"></p>
                                    <span class="text-[10px] px-1.5 py-0.5 rounded-md font-medium"
                                          :class="{'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400': order.payment==='pix','bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400': order.payment==='card','bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400': order.payment==='cash'}">
                                        <span x-show="order.payment==='pix'">üîë PIX</span>
                                        <span x-show="order.payment==='card'">üí≥ Cart√£o</span>
                                        <span x-show="order.payment==='cash'">üíµ Dinheiro</span>
                                    </span>
                                </div>
                            </div>
                            <div class="flex flex-wrap gap-1">
                                <template x-for="item in order.items" :key="item.name">
                                    <span class="text-xs bg-surface-muted text-text-muted px-2 py-0.5 rounded-lg" x-text="item.qty+'x '+item.name"></span>
                                </template>
                            </div>
                            <!-- UUID -->
                            <p x-show="order.uuid" class="text-[10px] font-mono text-text-muted mt-2 truncate" x-text="'UUID: '+order.uuid"></p>
                        </div>
                    </template>
                    <div x-show="orderHistory.length===0" class="text-center py-10 text-text-muted text-sm">Nenhum pedido registrado.</div>
                </div>
            </div>

            <!-- ‚îÄ‚îÄ REPORTS ‚îÄ‚îÄ -->
            <div x-show="adminTab==='reports'" class="space-y-5">
                <h2 class="admin-section-title">üìä Relat√≥rios & Fechamento</h2>
                <div class="grid grid-cols-2 gap-3">
                    <div class="admin-card text-center"><div class="text-3xl font-display font-bold text-accent" x-text="todayStats.orders"></div><div class="text-xs text-text-muted mt-1">Pedidos Hoje</div></div>
                    <div class="admin-card text-center"><div class="text-lg font-display font-bold text-accent" x-text="formatMoney(todayStats.revenue)"></div><div class="text-xs text-text-muted mt-1">Faturamento Hoje</div></div>
                    <div class="admin-card text-center"><div class="text-lg font-display font-bold text-text-primary" x-text="formatMoney(todayStats.avgTicket)"></div><div class="text-xs text-text-muted mt-1">Ticket M√©dio</div></div>
                    <div class="admin-card text-center"><div class="text-lg font-display font-bold text-text-primary" x-text="formatMoney(allTimeStats.totalRevenue)"></div><div class="text-xs text-text-muted mt-1">Total Geral</div></div>
                </div>
                <div class="admin-card space-y-3">
                    <h3 class="font-display font-bold text-text-primary text-sm">üí≥ Por Pagamento</h3>
                    <template x-for="method in [{id:'pix',name:'PIX',icon:'üîë',color:'#22c55e'},{id:'card',name:'Cart√£o',icon:'üí≥',color:'#3b82f6'},{id:'cash',name:'Dinheiro',icon:'üíµ',color:'#f59e0b'}]" :key="method.id">
                        <div class="flex items-center gap-3">
                            <span class="text-lg w-7 flex-shrink-0" x-text="method.icon"></span>
                            <div class="flex-1">
                                <div class="flex justify-between text-sm mb-1"><span class="text-text-secondary" x-text="method.name"></span><span class="font-bold text-text-primary" x-text="formatMoney(todayStats.byPayment[method.id])"></span></div>
                                <div class="h-2 bg-surface-muted rounded-full overflow-hidden"><div class="h-full rounded-full transition-all duration-500" :style="`width:${todayStats.revenue>0?(todayStats.byPayment[method.id]/todayStats.revenue*100):0}%;background:${method.color}`"></div></div>
                            </div>
                            <span class="text-xs text-text-muted w-10 text-right" x-text="todayStats.revenue>0?((todayStats.byPayment[method.id]/todayStats.revenue)*100).toFixed(0)+'%':'0%'"></span>
                        </div>
                    </template>
                </div>

                <!-- Fechamento + Exports -->
                <div class="admin-card border-2 border-accent/30" style="background:linear-gradient(135deg,rgba(var(--accent-rgb),.04) 0%,transparent 100%)">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-10 h-10 rounded-xl flex items-center justify-center text-xl" :style="'background:var(--accent-light)'">üìä</div>
                        <div><h3 class="font-display font-bold text-text-primary text-base">Fechamento Cont√°bil</h3><p class="text-xs text-text-muted" x-text="todayStats.date+' ‚Ä¢ '+todayStats.orders+' pedido(s) ‚Ä¢ '+formatMoney(todayStats.revenue)"></p></div>
                    </div>
                    <button @click="closeDayReport()" class="w-full py-3 rounded-2xl font-display font-bold text-white text-sm mb-4 transition-all active:scale-[0.98]" :style="'background:var(--accent)'">üîí Registrar Fechamento do Dia</button>
                    <p class="text-xs text-text-muted uppercase tracking-wider font-medium mb-3">Exportar Relat√≥rios</p>
                    <div class="grid grid-cols-2 gap-2">
                        <button @click="exportExcel()" class="export-btn flex flex-col items-center gap-2 p-4 rounded-2xl border-2 border-border bg-surface hover:border-green-400 hover:bg-green-50 dark:hover:bg-green-900/10 transition-all group">
                            <span class="text-2xl group-hover:scale-110 transition-transform">üìä</span>
                            <div class="text-center"><p class="text-xs font-bold text-text-primary">Excel</p><p class="text-[10px] text-text-muted">6 planilhas + auditoria</p></div>
                        </button>
                        <button @click="exportCSV()" class="export-btn flex flex-col items-center gap-2 p-4 rounded-2xl border-2 border-border bg-surface hover:border-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/10 transition-all group">
                            <span class="text-2xl group-hover:scale-110 transition-transform">üìÑ</span>
                            <div class="text-center"><p class="text-xs font-bold text-text-primary">CSV</p><p class="text-[10px] text-text-muted">Com UUID + hash</p></div>
                        </button>
                        <button @click="exportJSON()" class="export-btn flex flex-col items-center gap-2 p-4 rounded-2xl border-2 border-border bg-surface hover:border-yellow-400 hover:bg-yellow-50 dark:hover:bg-yellow-900/10 transition-all group">
                            <span class="text-2xl group-hover:scale-110 transition-transform">üíæ</span>
                            <div class="text-center"><p class="text-xs font-bold text-text-primary">JSON</p><p class="text-[10px] text-text-muted">Backup completo</p></div>
                        </button>
                        <button @click="printReport()" class="export-btn flex flex-col items-center gap-2 p-4 rounded-2xl border-2 border-border bg-surface hover:border-purple-400 hover:bg-purple-50 dark:hover:bg-purple-900/10 transition-all group">
                            <span class="text-2xl group-hover:scale-110 transition-transform">üñ®Ô∏è</span>
                            <div class="text-center"><p class="text-xs font-bold text-text-primary">Imprimir/PDF</p><p class="text-[10px] text-text-muted">Com integridade</p></div>
                        </button>
                    </div>
                    <div class="mt-3 bg-surface-muted rounded-xl p-3">
                        <p class="text-[10px] text-text-muted leading-relaxed">üí° <strong>Excel</strong> inclui planilha de Auditoria com hash chain. <strong>JSON</strong> cont√©m snapshot completo para o contador. Todos os pedidos possuem <strong>UUID √∫nico</strong> e <strong>hash de integridade</strong>.</p>
                    </div>
                </div>
            </div>

            <!-- ‚îÄ‚îÄ AUDIT LOG ‚îÄ‚îÄ -->
            <div x-show="adminTab==='audit'" class="space-y-4">
                <div class="flex items-center justify-between">
                    <h2 class="admin-section-title">üõ°Ô∏è Log de Auditoria</h2>
                    <button @click="exportAuditLog()" class="btn-primary text-xs px-3 py-1.5">‚¨áÔ∏è Exportar</button>
                </div>

                <!-- Integrity Status -->
                <div class="admin-card border-2"
                     :class="verifyAuditIntegrity() ? 'border-green-500/30' : 'border-red-500/50'"
                     :style="verifyAuditIntegrity() ? 'background:linear-gradient(135deg,rgba(34,197,94,.04) 0%,transparent 100%)' : 'background:linear-gradient(135deg,rgba(239,68,68,.06) 0%,transparent 100%)'">
                    <div class="flex items-center gap-3">
                        <div class="text-3xl" x-text="verifyAuditIntegrity() ? 'üõ°Ô∏è' : '‚ö†Ô∏è'"></div>
                        <div>
                            <h3 class="font-display font-bold text-sm"
                                :class="verifyAuditIntegrity() ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'"
                                x-text="verifyAuditIntegrity() ? 'Log √≠ntegro ‚Äî nenhuma adultera√ß√£o detectada' : '‚ö†Ô∏è ADULTERA√á√ÉO DETECTADA'"></h3>
                            <p class="text-xs text-text-muted mt-0.5">
                                <span x-text="auditLog.length"></span> entradas registradas ‚Ä¢
                                Hash encadeado (djb2) ‚Ä¢
                                <span x-show="auditLog.length > 0">√öltimo: <span class="font-mono" x-text="auditLog[auditLog.length-1]?.hash"></span></span>
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Filters -->
                <div class="admin-card space-y-3">
                    <div class="grid grid-cols-2 gap-2">
                        <div>
                            <label class="form-label">Filtrar por a√ß√£o</label>
                            <select x-model="auditFilter" class="form-input w-full text-xs">
                                <option value="all">Todos os eventos</option>
                                <option value="admin">Apenas Admin</option>
                                <option value="customer">Apenas Clientes</option>
                                <option value="ORDER_PLACED">Pedidos</option>
                                <option value="ADMIN_LOGIN_SUCCESS">Logins</option>
                                <option value="ADMIN_LOGIN_FAILED">Falhas de Login</option>
                                <option value="PRODUCT_CREATED">Produtos criados</option>
                                <option value="PRODUCT_DELETED">Produtos exclu√≠dos</option>
                                <option value="CONFIG_SAVED">Configura√ß√µes</option>
                                <option value="EXPORT_EXCEL">Exporta√ß√µes</option>
                                <option value="DAY_CLOSED">Fechamentos</option>
                            </select>
                        </div>
                        <div>
                            <label class="form-label">Buscar</label>
                            <input type="text" x-model="auditSearch" placeholder="Buscar no log‚Ä¶" class="form-input w-full">
                        </div>
                    </div>
                    <p class="text-xs text-text-muted"><span x-text="filteredAuditLog.length"></span> resultado(s)</p>
                </div>

                <!-- Log entries -->
                <div class="space-y-1.5 max-h-[600px] overflow-y-auto">
                    <template x-for="entry in filteredAuditLog.slice(0,100)" :key="entry.id">
                        <div class="audit-entry rounded-xl p-3 border border-border bg-surface-card hover:border-accent/20 transition-colors">
                            <div class="flex items-start gap-2.5">
                                <!-- Color indicator -->
                                <div class="w-8 h-8 rounded-lg flex items-center justify-center text-sm flex-shrink-0 mt-0.5"
                                     :class="{
                                       'bg-green-100 dark:bg-green-900/30': auditActionColor(entry.action)==='green',
                                       'bg-red-100 dark:bg-red-900/30':    auditActionColor(entry.action)==='red',
                                       'bg-yellow-100 dark:bg-yellow-900/30': auditActionColor(entry.action)==='yellow',
                                       'bg-blue-100 dark:bg-blue-900/30':  auditActionColor(entry.action)==='blue',
                                       'bg-purple-100 dark:bg-purple-900/30': auditActionColor(entry.action)==='purple',
                                       'bg-orange-100 dark:bg-orange-900/30': auditActionColor(entry.action)==='orange',
                                       'bg-surface-muted':                 auditActionColor(entry.action)==='gray',
                                     }" x-text="auditActionIcon(entry.action)"></div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-center justify-between gap-2 flex-wrap">
                                        <span class="text-sm font-bold text-text-primary" x-text="auditActionLabel(entry.action)"></span>
                                        <span class="text-[10px] font-mono text-text-muted flex-shrink-0" x-text="formatDatetime(entry.timestamp)"></span>
                                    </div>
                                    <!-- Data preview -->
                                    <div x-show="Object.keys(entry.data||{}).length > 0" class="mt-1 flex flex-wrap gap-1">
                                        <template x-for="[k,v] in Object.entries(entry.data||{})" :key="k">
                                            <span class="text-[10px] bg-surface-muted text-text-muted px-1.5 py-0.5 rounded font-mono">
                                                <span x-text="k"></span>: <span x-text="typeof v === 'object' ? JSON.stringify(v).slice(0,30) : String(v).slice(0,40)"></span>
                                            </span>
                                        </template>
                                    </div>
                                    <!-- Hash chain -->
                                    <div class="flex items-center gap-2 mt-1.5">
                                        <span class="text-[9px] font-mono text-text-muted">Hash: <span x-text="entry.hash"></span></span>
                                        <span class="text-[9px] bg-surface-muted px-1 rounded text-text-muted" x-text="entry.actor||'‚Äî'"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </template>
                    <div x-show="filteredAuditLog.length === 0" class="text-center py-10 text-text-muted text-sm">Nenhuma entrada no log ainda.</div>
                    <div x-show="filteredAuditLog.length > 100" class="text-center py-3 text-xs text-text-muted">
                        Exibindo 100 de <span x-text="filteredAuditLog.length"></span> entradas. Exporte para ver todas.
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê PRODUCT FORM MODAL (Admin) ‚Äî with Complements ‚ïê‚ïê‚ïê -->
    <div x-show="showProductForm" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" class="fixed inset-0 z-[60] flex items-end sm:items-center justify-center">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-sm" @click="showProductForm=false"></div>
        <div class="relative bg-surface-card w-full max-w-lg rounded-t-3xl sm:rounded-3xl shadow-2xl overflow-y-auto max-h-[92vh] p-6"
             x-transition:enter="transition ease-out duration-200" x-transition:enter-start="translate-y-full sm:scale-95 opacity-0" x-transition:enter-end="translate-y-0 sm:scale-100 opacity-100">
            <h3 class="font-display font-bold text-text-primary text-lg mb-5" x-text="editingProduct?.id ? '‚úèÔ∏è Editar Produto' : '‚ûï Novo Produto'"></h3>

            <div class="space-y-4">
                <!-- Basic Info -->
                <div><label class="form-label">Nome do produto *</label><input type="text" x-model="editingProduct.name" class="form-input w-full"></div>
                <div><label class="form-label">Descri√ß√£o</label><textarea x-model="editingProduct.desc" rows="2" class="form-input w-full resize-none"></textarea></div>
                <div class="grid grid-cols-2 gap-3">
                    <div><label class="form-label">Pre√ßo R$ *</label><input type="number" step="0.01" x-model.number="editingProduct.price" class="form-input w-full"></div>
                    <div><label class="form-label">Pre√ßo Promo R$</label><input type="number" step="0.01" x-model.number="editingProduct.promoPrice" placeholder="Opcional" class="form-input w-full"></div>
                </div>
                <div><label class="form-label">Categoria</label><select x-model="editingProduct.category" class="form-input w-full"><template x-for="cat in categories" :key="cat.id"><option :value="cat.id" x-text="cat.icon+' '+cat.name"></option></template></select></div>
                <div><label class="form-label">URL da imagem</label><input type="url" x-model="editingProduct.image" placeholder="https://‚Ä¶" class="form-input w-full"></div>
                <div x-show="editingProduct.image" class="rounded-xl overflow-hidden h-28"><img :src="editingProduct.image" class="w-full h-full object-cover" @error="editingProduct.image=''"></div>
                <div class="grid grid-cols-2 gap-3">
                    <div class="flex items-center justify-between bg-surface-muted rounded-xl p-3">
                        <span class="text-sm font-medium text-text-primary">Dispon√≠vel</span>
                        <button @click="editingProduct.available=!editingProduct.available" class="relative w-10 h-5 rounded-full transition-colors" :style="editingProduct.available?'background:var(--accent)':'background:#d1d5db'"><div class="absolute top-0.5 w-4 h-4 bg-white rounded-full shadow transition-transform" :class="editingProduct.available?'translate-x-5':'translate-x-0.5'"></div></button>
                    </div>
                    <div class="flex items-center justify-between bg-surface-muted rounded-xl p-3">
                        <span class="text-sm font-medium text-text-primary">Destaque</span>
                        <button @click="editingProduct.featured=!editingProduct.featured" class="relative w-10 h-5 rounded-full transition-colors" :style="editingProduct.featured?'background:var(--accent)':'background:#d1d5db'"><div class="absolute top-0.5 w-4 h-4 bg-white rounded-full shadow transition-transform" :class="editingProduct.featured?'translate-x-5':'translate-x-0.5'"></div></button>
                    </div>
                </div>

                <!-- ‚ïê‚ïê‚ïê COMPLEMENTS SECTION ‚ïê‚ïê‚ïê -->
                <div class="border-t border-dashed border-border pt-4">
                    <div class="flex items-center justify-between mb-3">
                        <div>
                            <h4 class="font-display font-bold text-text-primary text-sm">üß© Complementos & Adicionais</h4>
                            <p class="text-xs text-text-muted">Crie grupos de op√ß√µes (Ponto da carne, Adicionais, etc.)</p>
                        </div>
                        <span class="text-xs bg-accent/10 text-accent px-2 py-0.5 rounded-full font-bold" x-text="(editingProduct.complements||[]).length+' grupo(s)'"></span>
                    </div>

                    <!-- Existing Groups -->
                    <div class="space-y-3 mb-4">
                        <template x-for="(group, gIdx) in (editingProduct.complements||[])" :key="gIdx">
                            <div class="complement-group-admin rounded-xl border border-border overflow-hidden">
                                <!-- Group header -->
                                <div class="flex items-center justify-between px-3 py-2 bg-surface-muted border-b border-border">
                                    <div class="flex items-center gap-2">
                                        <span class="text-xs font-bold px-2 py-0.5 rounded-full"
                                              :class="group.type==='single' ? 'bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400' : 'bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400'"
                                              x-text="group.type==='single' ? '‚óâ Radio' : '‚òë Multi'"></span>
                                        <span class="font-bold text-text-primary text-sm" x-text="group.name"></span>
                                        <span x-show="group.required" class="text-[10px] bg-red-100 text-red-600 px-1.5 py-0.5 rounded dark:bg-red-900/30">obrig.</span>
                                        <span class="text-[10px] text-text-muted">max: <span x-text="group.max"></span></span>
                                    </div>
                                    <button @click="removeComplementGroup(gIdx)" class="text-red-400 hover:text-red-600 text-xs px-2 py-1 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20">‚úï</button>
                                </div>
                                <!-- Options list -->
                                <div class="p-2 space-y-1">
                                    <template x-for="(opt, oIdx) in group.options" :key="oIdx">
                                        <div class="flex items-center gap-2 bg-surface-muted rounded-lg px-3 py-2">
                                            <span class="flex-1 text-sm text-text-primary" x-text="opt.name"></span>
                                            <span class="text-xs font-bold" :class="opt.price>0?'text-accent':'text-text-muted'" x-text="opt.price>0?'+'+formatMoney(opt.price):'gr√°tis'"></span>
                                            <button @click="removeComplementOption(gIdx, oIdx)" class="text-red-400 hover:text-red-600 text-xs w-5 h-5 rounded flex items-center justify-center">‚úï</button>
                                        </div>
                                    </template>
                                    <!-- Add option inline -->
                                    <div class="flex gap-2 mt-2">
                                        <input type="text" x-model="newGroupOption.name" placeholder="Nova op√ß√£o‚Ä¶" class="form-input flex-1 text-xs py-1.5" @keyup.enter="addComplementOption(gIdx)">
                                        <input type="number" x-model.number="newGroupOption.price" placeholder="R$" step="0.50" class="form-input w-20 text-xs py-1.5">
                                        <button @click="addComplementOption(gIdx)" class="px-3 py-1.5 rounded-lg text-white text-xs font-bold" :style="'background:var(--accent)'">+</button>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>

                    <!-- Add new group form -->
                    <div class="bg-surface-muted rounded-xl p-3 space-y-2.5">
                        <p class="text-xs font-bold text-text-muted uppercase tracking-wider">Novo Grupo de Complemento</p>
                        <input type="text" x-model="newGroup.name" placeholder="Nome do grupo (ex: Ponto da Carne)" class="form-input w-full text-sm">
                        <div class="grid grid-cols-2 gap-2">
                            <select x-model="newGroup.type" class="form-input text-sm">
                                <option value="single">‚óâ Escolha √∫nica (radio)</option>
                                <option value="multiple">‚òë M√∫ltipla escolha</option>
                            </select>
                            <input type="number" x-model.number="newGroup.max" placeholder="M√°x. sele√ß√µes" min="1" class="form-input text-sm">
                        </div>
                        <div class="flex items-center gap-2">
                            <label class="flex items-center gap-2 text-sm text-text-primary cursor-pointer">
                                <input type="checkbox" x-model="newGroup.required" class="rounded">
                                Obrigat√≥rio
                            </label>
                        </div>
                        <button @click="addComplementGroup()" class="w-full py-2 rounded-xl text-white font-bold text-sm" :style="'background:var(--accent)'">+ Adicionar Grupo</button>
                    </div>
                </div>

                <button @click="saveProduct()" class="btn-primary w-full mt-2" x-text="editingProduct?.id ? 'üíæ Salvar Altera√ß√µes' : '+ Adicionar Produto'"></button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê TUTORIAL MODAL ‚ïê‚ïê‚ïê -->
    <div x-show="showTutorial" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" class="fixed inset-0 z-[70] flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-sm" @click="showTutorial=false"></div>
        <div class="relative bg-surface-card w-full max-w-sm rounded-3xl shadow-2xl overflow-hidden" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="scale-90 opacity-0" x-transition:enter-end="scale-100 opacity-100">
            <div class="flex gap-1.5 justify-center pt-5 px-6">
                <template x-for="(step, i) in tutorialSteps" :key="i">
                    <div class="h-1.5 rounded-full transition-all duration-300" :class="i===tutorialStep?'w-6':'w-1.5 bg-border'" :style="i===tutorialStep?'background:var(--accent);width:1.5rem':''"></div>
                </template>
            </div>
            <div class="p-6">
                <template x-if="tutorialSteps[tutorialStep]">
                    <div>
                        <div class="text-center mb-4">
                            <div class="text-5xl mb-3" x-text="tutorialSteps[tutorialStep].icon"></div>
                            <h3 class="font-display font-bold text-text-primary text-xl mb-1" x-text="tutorialSteps[tutorialStep].title"></h3>
                            <p class="text-sm text-text-secondary leading-relaxed" x-text="tutorialSteps[tutorialStep].content"></p>
                        </div>
                        <div class="bg-surface-muted rounded-2xl p-3 mb-5"><p class="text-xs text-text-muted leading-relaxed"><span class="text-accent font-bold">üí° </span><span x-text="tutorialSteps[tutorialStep].tip"></span></p></div>
                    </div>
                </template>
                <div class="flex gap-2">
                    <button x-show="tutorialStep>0" @click="tutorialStep--" class="flex-1 py-3 rounded-2xl border-2 border-border font-medium text-sm text-text-primary hover:border-accent hover:text-accent transition-all">‚Üê Anterior</button>
                    <button x-show="tutorialStep===0" @click="showTutorial=false" class="flex-1 py-3 rounded-2xl border-2 border-border font-medium text-sm text-text-muted">Pular</button>
                    <button @click="if(tutorialStep<tutorialSteps.length-1) tutorialStep++; else showTutorial=false" class="flex-1 py-3 rounded-2xl font-bold text-sm text-white" :style="'background:var(--accent)'">
                        <span x-show="tutorialStep<tutorialSteps.length-1">Pr√≥ximo ‚Üí</span>
                        <span x-show="tutorialStep===tutorialSteps.length-1">üéâ Concluir</span>
                    </button>
                </div>
                <p class="text-center text-xs text-text-muted mt-3"><span x-text="tutorialStep+1"></span> de <span x-text="tutorialSteps.length"></span></p>
            </div>
        </div>
    </div>

    <!-- Floating Cart Preview -->
    <div x-show="cart.length > 0 && !showCart"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0 translate-y-4"
         x-transition:enter-end="opacity-100 translate-y-0"
         class="fixed bottom-6 left-1/2 -translate-x-1/2 z-30">
        <button @click="showCart=true"
                class="flex items-center gap-3 px-5 py-3.5 rounded-2xl text-white shadow-2xl transition-all active:scale-95 font-medium"
                :style="'background:var(--accent)'">
            <span class="bg-white/20 rounded-lg px-2 py-0.5 font-display font-bold text-sm" x-text="cartTotalItems"></span>
            <span class="text-sm">Ver Pedido</span>
            <span class="font-display font-bold text-sm" x-text="formatMoney(orderTotal)"></span>
        </button>
    </div>

    <script src="app.js"></script>
</body>
</html>